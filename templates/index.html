{{template "head" .}}

<main class="container">
    <!-- Project Description Section -->
    <div class="card" style="margin-bottom: 24px; padding: 24px;">
        <h2 style="margin-bottom: 12px; font-size: 18px;">About gitraf</h2>
        <p style="color: var(--text-secondary); margin-bottom: 12px;">
            A lightweight, self-hosted git server. Simple, fast, and free from corporate control.
        </p>
        <p style="color: var(--text-secondary); font-size: 13px;">
            This project is maintained by a single developer and is provided as-is.
            While care is taken to ensure stability, bugs may exist.
            <a href="https://github.com/RafayelGardishyan/gitraf-ecosystem" target="_blank">Contributions are always welcome!</a>
        </p>
    </div>

    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
        <h1 style="font-size: 24px; margin: 0;">Repositories</h1>
        {{if .IsTailnet}}
        <a href="/new" style="display: inline-flex; align-items: center; gap: 8px; padding: 8px 16px; background: var(--link); color: white; text-decoration: none; border-radius: 6px; font-size: 14px; font-weight: 500;">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"/>
            </svg>
            New
        </a>
        {{end}}
    </div>

    {{if .Repos}}
    <div class="card">
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: var(--bg-secondary);">
                    <th style="text-align: left; padding: 12px 16px; border-bottom: 1px solid var(--border);">Name</th>
                    <th style="text-align: left; padding: 12px 16px; border-bottom: 1px solid var(--border);">Description</th>
                    <th style="text-align: left; padding: 12px 16px; border-bottom: 1px solid var(--border);">Visibility</th>
                    <th style="text-align: right; padding: 12px 16px; border-bottom: 1px solid var(--border);">Updated</th>
                </tr>
            </thead>
            <tbody>
                {{range .Repos}}
                <tr style="border-bottom: 1px solid var(--border);">
                    <td style="padding: 12px 16px;">
                        <a href="/{{.Name}}" style="font-weight: 600;">{{.Name}}</a>
                    </td>
                    <td style="padding: 12px 16px; color: var(--text-secondary);">
                        {{if .Description}}{{.Description}}{{else}}-{{end}}
                    </td>
                    <td style="padding: 12px 16px;">
                        {{if .IsPublic}}
                        <span class="badge badge-public">public</span>
                        {{else}}
                        <span class="badge badge-private">private</span>
                        {{end}}
                    </td>
                    <td style="padding: 12px 16px; text-align: right; color: var(--text-secondary);">
                        {{if not .LastCommit.IsZero}}
                        {{.LastCommit.Format "Jan 2, 2006"}}
                        {{else}}
                        -
                        {{end}}
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>
    {{else}}
    <div style="text-align: center; padding: 48px; color: var(--text-secondary);">
        <p>No repositories found.</p>
        {{if not .IsTailnet}}
        <p style="margin-top: 8px; font-size: 13px;">Connect via tailnet to see private repositories.</p>
        {{end}}
    </div>
    {{end}}

    <div class="status-bar" style="margin-top: 16px;">
        {{len .Repos}} repositories
        {{if .IsTailnet}}
        (showing all)
        {{else}}
        (showing public only)
        {{end}}
    </div>
</main>

{{template "footer" .}}
